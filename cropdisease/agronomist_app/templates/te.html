<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agronomist Image Upload</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        .preview-container {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background-color: #f8f9fa;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .preview-image {
            max-width: 100%;
            max-height: 280px;
            border-radius: 4px;
        }
        .thumbnail-container {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            gap: 10px;
        }
        .thumbnail {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
            border: 2px solid transparent;
            cursor: pointer;
        }
        .thumbnail.active {
            border-color: #0d6efd;
        }
        .upload-btn {
            position: relative;
            overflow: hidden;
        }
        .upload-btn input[type=file] {
            position: absolute;
            top: 0;
            right: 0;
            min-width: 100%;
            min-height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .empty-state {
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow">
                    <div class="card-header bg-success text-white">
                        <h3 class="mb-0"><i class="bi bi-images"></i> Agronomist Image Upload</h3>
                    </div>
                    <div class="card-body">
                        <!-- Upload Section -->
                        <div class="mb-4">
                            <label class="form-label">Upload crop images:</label>
                            <div class="upload-btn btn btn-primary btn-lg w-100">
                                <i class="bi bi-cloud-arrow-up"></i> Select Images
                                <input type="file" id="imageUpload" multiple accept="image/*">
                            </div>
                            <div class="form-text">Select multiple images to upload (JPEG, PNG, GIF)</div>
                        </div>

                        <!-- Thumbnail Navigation -->
                        <div class="mb-3">
                            <h5>Image Previews <span id="imageCount" class="badge bg-secondary">0</span></h5>
                            <div class="thumbnail-container" id="thumbnailContainer">
                                <div class="empty-state">No images uploaded yet</div>
                            </div>
                        </div>

                        <!-- Main Preview -->
                        <div class="preview-container mb-3" id="previewContainer">
                            <div class="empty-state">
                                <i class="bi bi-image fs-1 d-block"></i>
                                <p>Upload images to see preview</p>
                            </div>
                        </div>

                        <!-- Navigation Controls -->
                        <div class="d-flex justify-content-between align-items-center">
                            <button id="prevBtn" class="btn btn-outline-secondary" disabled>
                                <i class="bi bi-chevron-left"></i> Previous
                            </button>
                            <span id="imageCounter" class="text-muted">0 of 0</span>
                            <button id="nextBtn" class="btn btn-outline-secondary" disabled>
                                Next <i class="bi bi-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-footer text-muted">
                        <small>Use this tool to document crop health, growth patterns, and issues for analysis.</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const imageUpload = document.getElementById('imageUpload');
            const thumbnailContainer = document.getElementById('thumbnailContainer');
            const previewContainer = document.getElementById('previewContainer');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const imageCounter = document.getElementById('imageCounter');
            const imageCount = document.getElementById('imageCount');
            
            // State
            let images = [];
            let currentIndex = 0;
            
            // Handle file selection
            imageUpload.addEventListener('change', function(e) {
                const files = e.target.files;
                
                if (files.length > 0) {
                    // Clear empty state if first upload
                    if (images.length === 0) {
                        thumbnailContainer.innerHTML = '';
                        previewContainer.innerHTML = '';
                    }
                    
                    // Process each file
                    Array.from(files).forEach(file => {
                        if (file.type.match('image.*')) {
                            const reader = new FileReader();
                            
                            reader.onload = function(e) {
                                const imageData = {
                                    src: e.target.result,
                                    name: file.name,
                                    type: file.type
                                };
                                
                                images.push(imageData);
                                updateThumbnails();
                                
                                // If first image, show it
                                if (images.length === 1) {
                                    showImage(0);
                                }
                                
                                updateImageCounter();
                                updateNavigation();
                            };
                            
                            reader.readAsDataURL(file);
                        }
                    });
                }
            });
            
            // Update thumbnail display
            function updateThumbnails() {
                thumbnailContainer.innerHTML = '';
                
                images.forEach((image, index) => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = image.src;
                    thumbnail.className = 'thumbnail' + (index === currentIndex ? ' active' : '');
                    thumbnail.alt = 'Thumbnail ' + (index + 1);
                    thumbnail.addEventListener('click', () => showImage(index));
                    
                    thumbnailContainer.appendChild(thumbnail);
                });
                
                imageCount.textContent = images.length;
            }
            
            // Show selected image
            function showImage(index) {
                if (images.length === 0) return;
                
                currentIndex = index;
                
                // Update main preview
                previewContainer.innerHTML = `
                    <img src="${images[index].src}" alt="Preview" class="preview-image">
                    <div class="position-absolute bottom-0 start-0 m-2">
                        <span class="badge bg-dark">${index + 1}/${images.length}</span>
                    </div>
                `;
                
                // Update active thumbnail
                document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                    thumb.classList.toggle('active', i === index);
                });
                
                updateImageCounter();
                updateNavigation();
            }
            
            // Update image counter text
            function updateImageCounter() {
                imageCounter.textContent = `${currentIndex + 1} of ${images.length}`;
            }
            
            // Update navigation buttons state
            function updateNavigation() {
                prevBtn.disabled = images.length <= 1 || currentIndex === 0;
                nextBtn.disabled = images.length <= 1 || currentIndex === images.length - 1;
            }
            
            // Navigation button handlers
            prevBtn.addEventListener('click', () => {
                if (currentIndex > 0) {
                    showImage(currentIndex - 1);
                }
            });
            
            nextBtn.addEventListener('click', () => {
                if (currentIndex < images.length - 1) {
                    showImage(currentIndex + 1);
                }
            });
        });
    </script>
</body>
</html>